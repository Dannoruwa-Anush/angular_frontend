<div class="dashboard-container">

  <!-- SEARCH / INPUT -->
  <mat-card class="section-card">
    <form [formGroup]="form">

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Order No</mat-label>
          <input matInput type="number" formControlName="orderId" />
        </mat-form-field>

        <button
          mat-raised-button
          color="primary"
          type="button"
          (click)="loadSnapshot()">
          Load
        </button>
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Payment Amount</mat-label>
        <input matInput type="number" formControlName="paymentAmount" />
      </mat-form-field>

      <div class="form-actions">
        <button
          mat-raised-button
          color="accent"
          type="button"
          (click)="simulate()">
          Simulate Payment
        </button>

        <button
          mat-stroked-button
          color="warn"
          type="button"
          (click)="reset()">
          Reset
        </button>
      </div>
    </form>
  </mat-card>

  <!-- SNAPSHOT -->
  <mat-card *ngIf="snapshot() as s" class="section-card">

    <div class="snapshot-header">
      <div>
        <span class="label">Current Installment No</span>
        <span class="value">{{ s.currentInstallmentNo }}</span>
      </div>

      <div class="total-payable-box">
        <span class="label">Total Payable</span>
        <span class="value">
          {{ s.total_PayableSettlement | number:'1.2-2' }}
        </span>
      </div>
    </div>

    <table mat-table
           [dataSource]="snapshotTableData()"
           class="snapshot-table">

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef>Description</th>
        <td mat-cell *matCellDef="let r">{{ r.description }}</td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef class="text-right">Amount</th>
        <td mat-cell *matCellDef="let r" class="text-right">
          {{ r.amount | number:'1.2-2' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="paid">
        <th mat-header-cell *matHeaderCellDef class="text-right">Paid</th>
        <td mat-cell *matCellDef="let r" class="text-right">
          {{ r.paid | number:'1.2-2' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="result">
        <th mat-header-cell *matHeaderCellDef class="text-right">Simulation Result</th>
        <td mat-cell *matCellDef="let r" class="text-right result">
          {{ r.result | number:'1.2-2' }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="snapshotColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: snapshotColumns" [ngClass]="getRowClass(row)"></tr>
    </table>

    <button
      mat-raised-button
      color="primary"
      class="invoice-btn"
      [disabled]="!simulation()"
      (click)="generateInvoice()">
      Generate Invoice
    </button>

  </mat-card>
</div>
