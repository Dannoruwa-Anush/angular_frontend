<div class="simulator-container">

  <!-- CUSTOMER SEARCH -->
  <div *ngIf="!customerId()" class="boxed-row">
    <button mat-stroked-button color="primary" (click)="openCustomerSearch()">
      Search Customer
    </button>
  </div>

  <!-- ORDERS TABLE -->
  <div *ngIf="orders().length" class="card-wrapper">
    <mat-card class="section-card">

      <div class="card-header">
        <div class="card-title">Customer Orders</div>
        <div class="card-subtitle">Select an order to continue</div>
      </div>

      <table mat-table [dataSource]="orders()" class="snapshot-table">

        <ng-container matColumnDef="orderId">
          <th mat-header-cell *matHeaderCellDef>Order #</th>
          <td mat-cell *matCellDef="let o">{{ o.orderID }}</td>
        </ng-container>

        <ng-container matColumnDef="total">
          <th mat-header-cell *matHeaderCellDef class="text-right">Total</th>
          <td mat-cell *matCellDef="let o" class="text-right">
            {{ o.totalAmount | number:'1.2-2' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef></th>
          <td mat-cell *matCellDef="let o">
            <button mat-flat-button color="primary" (click)="selectOrder(o)">
              Select
            </button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="orderColumns"></tr>
        <tr
          mat-row
          *matRowDef="let row; columns: orderColumns"
          [ngClass]="{ 'selected-row': selectedOrder()?.orderID === row.orderID }">
        </tr>

      </table>
    </mat-card>
  </div>

  <!-- SNAPSHOT -->
  <div *ngIf="snapshot()" class="card-wrapper">
    <mat-card class="section-card">

      <div class="card-header">
        <div class="card-title">Installment Snapshot</div>
      </div>

      <table mat-table [dataSource]="snapshotTableData()" class="snapshot-table">

        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let r">{{ r.description }}</td>
        </ng-container>

        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef class="text-right">Amount</th>
          <td mat-cell *matCellDef="let r" class="text-right">
            {{ r.amount | number:'1.2-2' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="paid">
          <th mat-header-cell *matHeaderCellDef class="text-right">Paid</th>
          <td mat-cell *matCellDef="let r" class="text-right">
            {{ r.paid | number:'1.2-2' }}
          </td>
        </ng-container>

        <ng-container matColumnDef="result">
          <th mat-header-cell *matHeaderCellDef class="text-right">Remaining</th>
          <td mat-cell *matCellDef="let r" class="text-right">
            {{ r.result | number:'1.2-2' }}
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="snapshotColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: snapshotColumns"
            [ngClass]="getRowClass(row)">
        </tr>

      </table>

      <!-- PAYMENT SIMULATION -->
      <div class="payment-simulation" [formGroup]="form">

        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Payment Amount</mat-label>
          <input matInput type="number" formControlName="paymentAmount" />
        </mat-form-field>

        <div class="form-actions">
          <button mat-raised-button color="accent" (click)="simulate()">
            Simulate Payment
          </button>

          <button mat-stroked-button color="warn" (click)="reset()">
            Reset
          </button>
        </div>

      </div>

      <!-- GENERATE INVOICE -->
      <div class="snapshot-actions">
        <button
          mat-raised-button
          color="primary"
          [disabled]="!simulation()"
          (click)="generateInvoice()">
          <mat-icon>print</mat-icon>
          Generate Invoice
        </button>
      </div>

    </mat-card>
  </div>

</div>
