<div class="dialog-shell">
<mat-dialog-content class="calculator-content">

  <div class="calculator-grid">

    <!-- LEFT : FORM -->
    <mat-card class="calc-card">
      <mat-card-title>Installment Plan</mat-card-title>
      <mat-card-subtitle>
        Customize your Buy Now, Pay Later plan
      </mat-card-subtitle>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>BNPL Plan Type</mat-label>
        <mat-select [(ngModel)]="planType">
          <mat-option value="MONTHLY">Monthly</mat-option>
          <mat-option value="QUARTERLY">Quarterly</mat-option>
          <mat-option value="YEARLY">Yearly</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Initial Payment (Rs.)</mat-label>
        <input matInput type="number" [(ngModel)]="initialPayment" min="0">
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Number of Installments</mat-label>
        <input matInput type="number" [(ngModel)]="installmentCount" min="1">
      </mat-form-field>

      <button
        mat-stroked-button
        color="primary"
        class="full-width"
        (click)="calculate()">
        Calculate
      </button>
    </mat-card>

    <!-- RIGHT : SUMMARY -->
    <mat-card class="summary-card">
      <mat-card-title>Plan Summary</mat-card-title>

      <ng-container *ngIf="calculated; else emptyState">
        <div class="summary-row">
          <span>Total Amount</span>
          <strong>Rs. {{ data.total | number:'1.2-2' }}</strong>
        </div>

        <div class="summary-row">
          <span>Initial Payment</span>
          <strong>Rs. {{ initialPayment | number:'1.2-2' }}</strong>
        </div>

        <div class="summary-row">
          <span>Remaining</span>
          <strong>Rs. {{ remainingAmount | number:'1.2-2' }}</strong>
        </div>

        <mat-divider></mat-divider>

        <div class="summary-row highlight">
          <span>
            {{ installmentCount }} Installments
            ({{ planType }})
          </span>
          <strong>
            Rs. {{ installmentAmount | number:'1.2-2' }}
          </strong>
        </div>
      </ng-container>

      <ng-template #emptyState>
        <p class="hint">
          Enter details and calculate to see installment summary.
        </p>
      </ng-template>
    </mat-card>

  </div>

</mat-dialog-content>

<!-- FOOTER -->
<mat-dialog-actions align="end" class="dialog-footer">
  <button mat-button (click)="cancel()">Cancel</button>
  <button
    mat-raised-button
    color="accent"
    [disabled]="!calculated"
    (click)="finalizePlan()">
    Confirm Plan
  </button>
</mat-dialog-actions>
</div>

